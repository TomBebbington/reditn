// ==UserScript==
// @name			Reditn
// @namespace		http://userscripts.org/user/tophattedcoder/
// @description		Reddit tweaks and enhancements.
// @include			reddit.com
// @include			reddit.com/*
// @include			*.reddit.com
// @include			*.reddit.com/*
// @version			1.5.7
// @grant			none
// ==/UserScript==
 
(function(){var h={},u=function(){return f.Boot.__string_rec(this,"")},x=function(){};h.Adblock=x;x.__name__=["Adblock"];x.init=function(){x.hideAll(f.Browser.document.body.getElementsByClassName("promoted"));x.hideAll(f.Browser.document.body.getElementsByClassName("infobar"));x.hideAll(f.Browser.document.body.getElementsByClassName("goldvertisement"));var a=f.Browser.document.getElementById("spotlight-help");null!=a&&j.show(a.parentNode.parentNode,!1);a=f.Browser.document.getElementById("ad-frame");
null!=a&&(a.style.display="none",-1!=a.className.indexOf("link")&&g.remove(j.links,a.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]))};x.hideAll=function(a){for(var b=0,c=a.length;b<c;){var d=b++;j.show(a[d],!1)}};var I=function(){};h.DuplicateHider=I;I.__name__=["DuplicateHider"];I.init=function(){for(var a=[],b=0,c=j.links;b<c.length;){var d=c[b];++b;"a"==d.nodeName.toLowerCase()&&(J.has(a,d.href)?j.show(d.parentNode.parentNode.parentNode,!1):a.push(d.href))}};var n=function(a,
b){b=b.split("u").join("");this.r=RegExp(a,b)};h.EReg=n;n.__name__=["EReg"];n.prototype={replace:function(a,b){return a.replace(this.r,b)},__class__:n};var l=function(){};h.Expand=l;l.__name__=["Expand"];l.get_expanded=function(){var a;if(l.toggled)a=[];else{a=[];for(var b=0,c=l.buttons;b<c.length;){var d=c[b];++b;d.toggled()&&a.push(d.url)}}return a};l.set_expanded=function(a){a.length==l.buttons.length?l.toggle(!0):0>=a.length&&l.toggle(!1);for(var b=0,c=l.buttons;b<c.length;){var d=c[b];++b;for(var w=
!1,f=0;f<a.length;){var e=a[f];++f;w=w||d.url==e}d.toggle(w,!1)}return a};l.init=function(){l.toggled="#showall"==f.Browser.window.location.hash;var a=f.Browser.document.getElementsByClassName("tabmenu")[0],b=f.Browser.document.createElement("li");l.button=f.Browser.document.createElement("a");l.button.href="javascript:void(0);";l.refresh();l.button.onclick=function(){l.toggle(!l.toggled);f.Browser.window.history.pushState(e.Serializer.run(j.state()),null,l.toggled?"#showall":null)};b.appendChild(l.button);
null!=a&&a.appendChild(b);a=0;for(b=j.links;a<b.length;){var c=[b[a]];++a;"a"==c[0].nodeName.toLowerCase()&&(j.getLinkType(c[0].href)==r.LinkType.IMAGE?l.getImageLink(c[0].href,c[0],function(a){return function(b){for(var c=a[0].parentNode.parentNode,e=f.Browser.document.createElement("div"),m=[],z=0;z<b.length;){var n=b[z];++z;m.push(function(){var a=l.loadImage(n.url);e.appendChild(a);a.style.display="none";-1!=a.className.indexOf("link")&&g.remove(j.links,a.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]);
return a}(this))}var h=null,p=f.Browser.document.createElement("span");p.style.fontWeight="bold";p.style.marginLeft="10px";var q=0,r=null,s=null,t=null;1<b.length&&(r=f.Browser.document.createElement("button"),r.innerHTML="Prev",e.appendChild(r),s=f.Browser.document.createElement("span"),s.style.textAlign="center",s.style.paddingLeft=s.style.paddingRight="5px",e.appendChild(s),t=f.Browser.document.createElement("button"),t.innerHTML="Next",e.appendChild(t));if(1<b.length||null!=b[0].caption&&0<b[0].caption.length)e.appendChild(p),
e.appendChild(f.Browser.document.createElement("br"));var u=function(a){if(!(0>a||a>=b.length)){var c=b[a],d=null;null!=h&&(h.style.display="none",-1!=h.className.indexOf("link")&&g.remove(j.links,h.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]),d=h.height);h=m[a];h.style.display="";-1!=h.className.indexOf("link")&&g.remove(j.links,h.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]);if(null!=d){var f=h.width/h.height;h.height=d;h.width=d*f|0}e.appendChild(h);null!=
r&&(d=j.formatNumber(b.length),f=j.formatNumber(a+1),s.innerHTML=""+f+" of "+d,r.disabled=0>=a,t.disabled=a>=b.length-1);p.style.display=null!=c.caption?"":"none";-1!=p.className.indexOf("link")&&g.remove(j.links,p.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]);null!=c.caption&&(p.innerHTML=k.htmlEscape(c.caption))}};u(0);null!=r&&(r.onmousedown=function(){u(--q)},t.onmousedown=function(){u(++q)});c.appendChild(e);e.style.display=l.toggled?"":"none";-1!=e.className.indexOf("link")&&
g.remove(j.links,e.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]);z=f.Browser.document.createElement("li");z.className="reditn-expand";var v=l.showButton(e,z);l.buttons.push(v);c=c.getElementsByClassName("buttons")[0];if(null!=c)c.insertBefore(z,c.childNodes[0]);else throw"Bad DOM";l.refresh()}}(c)):l.preload(c[0].href))}};l.refresh=function(){if(null!=l.button){l.button.innerHTML=""+(l.toggled?"hide":"show")+" images ("+l.buttons.length+")";for(var a=[],b=f.Browser.document.body.getElementsByClassName("next"),
c=f.Browser.document.body.getElementsByClassName("prev"),d=0;d<b.length;){var e=b[d];++d;a.push(e)}for(d=0;d<c.length;)b=c[d],++d,a.push(b);for(d=0;d<a.length;)c=a[d],++d,"a"==c.nodeName.toLowerCase()&&(l.toggled&&-1==c.href.indexOf("#")?c.href+="#showall":!l.toggled&&-1!=c.href.indexOf("#")&&(c.href=g.substr(c.href,0,c.href.indexOf("#"))));j.show(l.button,0<l.buttons.length)}};l.toggle=function(a){l.toggled=a;for(var b=0,c=l.buttons;b<c.length;){var d=c[b];++b;d.toggle(a,!1)}l.refresh()};l.showButton=
function(a,b){var c=f.Browser.document.createElement("a");c.style.fontStyle="italic";c.href="javascript:void(0);";c.className="toggle";var d=l.toggled;c.innerHTML=d?"hide":"show";c.toggle=function(b,M){null==M&&(M=!0);d=null==b?!d:b;c.innerHTML=d?"hide":"show";a.style.display=d?"":"none";-1!=a.className.indexOf("link")&&g.remove(j.links,a.getElementsByClassName("entry")[0].getElementsByTagName("a")[0]);M&&f.Browser.window.history.pushState(e.Serializer.run(j.state()),null,null)};c.toggled=function(){return d};
c.onclick=function(){c.toggle()};b.appendChild(c);return c};l.getImageLink=function(a,b,c){b=a;k.startsWith(b,"http://")?b=g.substr(b,7,null):k.startsWith(b,"https://")&&(b=g.substr(b,8,null));k.startsWith(b,"www.")&&(b=g.substr(b,4,null));-1!=b.indexOf("&")&&(b=g.substr(b,0,b.indexOf("&")));-1!=b.indexOf("?")&&(b=g.substr(b,0,b.indexOf("?")));k.startsWith(b,"i.imgur.com/")&&3==b.split(".").length?c([{url:"http://"+b+".jpg",caption:null}]):k.startsWith(b,"imgur.com/a/")||k.startsWith(b,"imgur.com/gallery/")?
(a=b.split("/")[2],b=-1!=b.indexOf("gallery")?"gallery/album":"album",a=new e.Http("https://api.imgur.com/3/"+b+"/"+a),a.setHeader("Authorization","Client-ID cc1f254578d6c52"),a.onData=function(a){var b=j.getData(e.Json.parse(a));a=[];if(0>=b.images_count)a.push({url:"http://i.imgur.com/"+b.id+".jpg",caption:b.title});else for(var f=0,b=b.images;f<b.length;){var g=b[f];++f;a.push({url:"http://i.imgur.com/"+g.id+".jpg",caption:g.title})}c(a)},a.request(!1)):k.startsWith(b,"imgur.com/")?(a=l.removeSymbols(g.substr(b,
b.indexOf("/")+1,null)),c(-1!=a.indexOf(",")?a.split(",").map(function(a){return{url:"http://i.imgur.com/"+a+".jpg",caption:null}}):[{url:"http://i.imgur.com/"+a+".jpg",caption:null}])):k.startsWith(b,"qkme.me/")?(a=l.removeSymbols(g.substr(b,8,null)),c([{url:"http://i.qkme.me/"+a+".jpg",caption:null}])):k.startsWith(b,"quickmeme.com/meme/")?(a=l.removeSymbols(g.substr(b,19,null)),c([{url:"http://i.qkme.me/"+a+".jpg",caption:null}])):k.startsWith(b,"m.quickmeme.com/meme/")?(a=l.removeSymbols(g.substr(b,
21,null)),c([{url:"http://i.qkme.me/"+a+".jpg",caption:null}])):k.startsWith(b,"memecrunch.com/meme/")?(a=b,"/"!=a.charAt(a.length-1)&&(a+="/"),c([{url:"http://"+a+"image.jpg",caption:null}])):k.startsWith(b,"memegenerator.net/instance/")?(a=l.removeSymbols(g.substr(b,27,null)),c([{url:"http://cdn.memegenerator.net/instances/400x/"+a+".jpg",caption:null}])):k.startsWith(b,"imgflip.com/i/")?(a=l.removeSymbols(g.substr(b,14,null)),c([{url:"http://i.imgflip.com/"+a+".jpg",caption:null}])):-1!=a.indexOf(".deviantart.com/art/")||
-1!=a.indexOf(".deviantart.com/")&&-1!=a.indexOf("#/d")||-1!=a.indexOf("fav.me")?j.getJSONP("http://backend.deviantart.com/oembed?url="+k.urlEncode(a)+"&format=jsonp&callback=",function(a){c([{url:a.url,caption:""+a.title+" by "+a.author_name}])}):k.startsWith(b,"flickr.com/photos/")?(a=g.substr(b,18,null),a=g.substr(a,a.indexOf("/")+1,null),a=g.substr(a,0,a.indexOf("/")),j.getJSONP("http://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key=99dcc3e77bcd8fb489f17e58191f32f7&photo_id="+
a+"&format=json&jsoncallback=",function(a){if(!(null==a.sizes||null==a.sizes.size)){a=a.sizes.size;for(var b=null,e=0,j=0;j<a.length;){var g=a[j];++j;var k=q.parseInt(g.width)*q.parseInt(g.height);if(null==b||k>=e&&k<=(0.7*f.Browser.window.innerWidth|0)*(0.6*f.Browser.window.innerHeight|0))b=g.source,e=k}null==b&&(b=a[0].source);c([{url:b,caption:null}])}})):c([{url:a,caption:null}])};l.preload=function(a){var b=f.Browser.document.createElement("link");b.href=a;b.rel="preload";f.Browser.document.head.appendChild(b)};
l.loadImage=function(a){var b=f.Browser.document.createElement("img");b.src=a;b.className="resize";l.initResize(b);var c=new e.Timer(30);c.run=function(){if(0<b.width&&0<b.height){c.stop();if(b.width>(0.7*f.Browser.window.innerWidth|0)){var a=b.height/b.width;b.width=0.7*f.Browser.window.innerWidth|0;b.height=b.width*a|0}b.height>(0.6*f.Browser.window.innerHeight|0)&&(a=b.width/b.height,b.height=0.6*f.Browser.window.innerHeight|0,b.width=b.height*a|0)}};return b};l.initResize=function(a){var b=0,
c=0,d=1,e=!1;a.onmousedown=function(f){e=!0;b=a.offsetWidth/f.clientX;c=a.offsetHeight/f.clientY;d=a.offsetWidth/a.offsetHeight;f.preventDefault()};a.onmousemove=function(f){if(e){var j=f.clientX*b,g=j/d,k=f.clientY*c,h=k*d;a.width=(g>k?j:h)|0;a.height=(g>k?g:k)|0}f.preventDefault()};a.onmouseup=a.onmouseout=function(a){e=!1;a.preventDefault()}};l.removeSymbols=function(a){return-1!=a.lastIndexOf("?")?g.substr(a,0,a.lastIndexOf("?")):-1!=a.lastIndexOf("/")?g.substr(a,0,a.lastIndexOf("/")):-1!=a.lastIndexOf("#")?
g.substr(a,0,a.lastIndexOf("#")):a};var g=function(){};h.HxOverrides=g;g.__name__=["HxOverrides"];g.dateStr=function(a){var b=a.getMonth()+1,c=a.getDate(),d=a.getHours(),e=a.getMinutes(),f=a.getSeconds();return a.getFullYear()+"-"+(10>b?"0"+b:""+b)+"-"+(10>c?"0"+c:""+c)+" "+(10>d?"0"+d:""+d)+":"+(10>e?"0"+e:""+e)+":"+(10>f?"0"+f:""+f)};g.strDate=function(a){switch(a.length){case 8:a=a.split(":");var b=new Date;b.setTime(0);b.setUTCHours(a[0]);b.setUTCMinutes(a[1]);b.setUTCSeconds(a[2]);return b;case 10:return a=
a.split("-"),new Date(a[0],a[1]-1,a[2],0,0,0);case 19:return a=a.split(" "),b=a[0].split("-"),a=a[1].split(":"),new Date(b[0],b[1]-1,b[2],a[0],a[1],a[2]);default:throw"Invalid date format : "+a;}};g.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};g.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};g.remove=function(a,b){for(var c=0,d=a.length;c<d;){if(a[c]==b)return a.splice(c,
1),!0;c++}return!1};g.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var s=function(){};h.Keyboard=s;s.__name__=["Keyboard"];s.get_highlighted=function(){return null==s.current?null:j.links[s.current].parentNode.parentNode.parentNode};s.init=function(){f.Browser.document.onkeydown=function(a){s.keyDown(a.keyCode)}};s.unhighlight=function(){var a=s.get_highlighted();null!=a&&(a.style.border="")};s.highlight=function(a){s.unhighlight();
null!=s.current&&j.links[s.current+a]&&(s.current+=a);null==s.current&&(s.current=0);a=s.get_highlighted();a.style.border="3px solid grey";a.scrollIntoView(!0);a.focus()};s.show=function(a){null==a&&(a=!0);var b=s.get_highlighted(),c=b.getElementsByClassName("toggle")[0];if(null!=c.toggle)c.toggle(a);else if(c=b.getElementsByClassName("expando-button")[0],null!=c&&(a?-1==c.className.indexOf("expanded"):-1!=c.className.indexOf("expanded")))c.onclick(null);b.scrollIntoView(!0);b.focus()};s.keyDown=
function(a){switch(a){case 39:s.show(!0);break;case 37:s.show(!1);break;case 38:s.highlight(-1);break;case 40:s.highlight(1)}};var J=function(){};h.Lambda=J;J.__name__=["Lambda"];J.has=function(a,b){var c;if(a instanceof Array)c=function(){return g.iter(a)};else if("function"==typeof a.iterator){c=a.iterator;var d=function(){return d.method.apply(d.scope,arguments)};d.scope=a;d.method=c;c=d}else c=a.iterator;for(c=c();c.hasNext();)if(c.next()==b)return!0;return!1};var B=function(){this.length=0};
h.List=B;B.__name__=["List"];B.prototype={iterator:function(){return{h:this.h,hasNext:function(){return null!=this.h},next:function(){if(null==this.h)return null;var a=this.h[0];this.h=this.h[1];return a}}},add:function(a){a=[a];null==this.h?this.h=a:this.q[1]=a;this.q=a;this.length++},__class__:B};var H=function(){};h.IMap=H;H.__name__=["IMap"];var y=function(){};h.Markdown=y;y.__name__=["Markdown"];y.parse=function(a){for(var b=0,c=y.regex;b<c.length;){var d=c[b];++b;a=d.from.replace(a,d.to)}return k.trim(a)};
var K=function(){};h.NSFWFilter=K;K.__name__=["NSFWFilter"];K.init=function(){for(var a=f.Browser.document.body.getElementsByClassName("nsfw-stamp"),b=0;b<a.length;){var c=a[b];++b;"li"==c.nodeName.toLowerCase()&&j.show(c.parentNode.parentNode.parentNode,!1)}};var C=function(){};h.Preview=C;C.__name__=["Preview"];C.init=function(){for(var a=f.Browser.document.body.getElementsByClassName("usertext-edit"),b=0;b<a.length;){var c=a[b];++b;C.preview(c)}};C.preview=function(a){var b=a.getElementsByTagName("textarea")[0];
if(null!=b){var c=f.Browser.document.createElement("div");a.appendChild(c);c.className="md";b.onchange=function(){c.innerHTML=y.parse(b.value)}}};var j=function(){};h.Reditn=j;j.__name__=["Reditn"];j.main=function(){"complete"==document.readyState?j.init():f.Browser.window.onload=function(){j.init()}};j.init=function(){if(-1!=f.Browser.window.location.href.indexOf("reddit.")){j.fullPage=0<f.Browser.document.getElementsByClassName("tabmenu").length;j.links=f.Browser.document.body.getElementsByClassName("title");
for(var a=[],b=0,c=j.links;b<c.length;){var d=c[b];++b;"a"==d.nodeName.toLowerCase()&&"parent"!=d.parentNode.className&&a.push(d)}j.links=a;j.wrap(m.init);j.wrap(x.init,"adblock");j.wrap(I.init,"dup-hider");j.wrap(K.init,"nsfw-filter");j.wrap(l.init,"expand");j.wrap(s.init,"keys");j.wrap(C.init,"preview");j.wrap(D.init,"subinfo");j.wrap(E.init,"userinfo");j.wrap(F.init,"user-tag");j.wrap(G.init,"sub-tag");f.Browser.window.history.replaceState(e.Serializer.run(j.state()),null,l.toggled?"#showall":
null);f.Browser.window.onpopstate=function(a){a=a.state;null!=a&&(a=e.Unserializer.run(a),l.set_expanded(a.expanded),a.allExpanded!=l.toggled&&l.toggle(a.allExpanded))}}};j.state=function(){return{allExpanded:l.toggled,expanded:l.get_expanded()}};j.wrap=function(a,b){var c=null==b?null:m.data.get(b);if(null==b||c)try{a()}catch(d){console.log("Module "+b+" has failed to load in Reditn due to the following error:\n "+q.string(d))}};j.formatNumber=function(a){if(Math.isFinite(a)){var b=q.string(Math.abs(a));
if(3<=b.length){for(var c="",d=0,e=b.length;d<e;){var f=d++,c=c+b.charAt(f);0==(b.length-(f+1))%3&&f<b.length-1&&(c+=",")}b=c}a=0>a?"-"+b:b}else a=q.string(a);return a};j.show=function(a,b){a.style.display=b?"":"none";-1!=a.className.indexOf("link")&&g.remove(j.links,a.getElementsByClassName("entry")[0].getElementsByTagName("a")[0])};j.age=function(a){a=e.Timer.stamp()-a;var b=a/86400%30.4375|0,c=a/2629800%12|0;a=a/2629800/12|0;var d="";0<a&&(d+=""+a+" year"+(1>=a?"":"s"));0<c&&(d+=", "+c+" month"+
(1>=c?"":"s"));d+=", "+b+" day"+(1>=b?"":"s");for(k.startsWith(d,", ")&&(d=g.substr(d,2,null));-1!=d.indexOf(", , ");)d=k.replace(d,", , ",", ");return d};j.getLinkType=function(a){k.startsWith(a,"http://")?a=g.substr(a,7,null):k.startsWith(a,"https://")&&(a=g.substr(a,8,null));k.startsWith(a,"www.")&&(a=g.substr(a,4,null));if("reddit.com/r/"==g.substr(a,0,13)&&-1!=a.indexOf("/comments/"))a=r.LinkType.TEXT;else if(a.lastIndexOf(".")!=a.indexOf(".")&&4>=g.substr(a,a.lastIndexOf("."),null).length)switch(g.substr(a,
a.lastIndexOf(".")+1,null).toLowerCase()){case "gif":case "jpg":case "jpeg":case "bmp":case "png":case "webp":case "svg":case "ico":case "tiff":case "raw":a=r.LinkType.IMAGE;break;case "mpg":case "webm":case "avi":case "mp4":case "flv":case "swf":a=r.LinkType.VIDEO;break;case "mp3":case "wav":case "midi":a=r.LinkType.AUDIO;break;default:a=r.LinkType.UNKNOWN}else a=k.startsWith(a,"xkcd.com/")||k.startsWith(a,"flickr.com/photos/")||-1!=a.indexOf(".deviantart.com/")&&-1!=a.indexOf("#/d")||-1!=a.indexOf(".deviantart.com/art")||
k.startsWith(a,"imgur.com/")&&-1==a.indexOf("/blog/")||k.startsWith(a,"i.imgur.com/")||k.startsWith(a,"qkme.me/")||k.startsWith(a,"m.quickmeme.com/meme/")||k.startsWith(a,"quickmeme.com/meme/")||k.startsWith(a,"memecrunch.com/meme/")||k.startsWith(a,"memegenerator.net/instance/")||k.startsWith(a,"imgflip.com/i/")||k.startsWith(a,"fav.me/")?r.LinkType.IMAGE:k.startsWith(a,"youtube.com/watch")||k.startsWith(a,"youtu.be/")?r.LinkType.VIDEO:r.LinkType.UNKNOWN;return a};j.getData=function(a){for(;null!=
a.data;)a=a.data;return a};j.getJSONP=function(a,b){var c=f.Browser.document.head,d="temp"+(9999999*Math.random()|0),e=f.Browser.document.createElement("script"),g=a+k.urlEncode(d);e.id="jsonp";window[d]=function(a){b(j.getData(a))};e.type="text/javascript";e.src=g;d=f.Browser.document.getElementById("jsonp");null!=d&&d.parentNode.removeChild(d);c.appendChild(e)};j.popUp=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);f.Browser.document.body.appendChild(b);b.className="popup";b.style.position="absolute";
b.style.width=(0.25*f.Browser.window.innerWidth|0)+"px";b.style.left=""+c+"px";b.style.top=""+d+"px";a.onmouseout=b.onblur=function(){b.parentNode.removeChild(b);a.mouseover=!1};return b};j.fullPopUp=function(a,b){null==b&&(b=0);var c=f.Browser.document.getElementsByClassName("popup")[0];null!=c&&c.parentNode.removeChild(c);f.Browser.document.body.appendChild(a);c=f.Browser.document.createElement("a");c.style.position="absolute";c.style.right=c.style.top="5px";c.innerHTML="<b>Close</b>";c.href="javascript:void(0);";
c.onclick=a.onblur=function(){a.parentNode.removeChild(a)};a.appendChild(c);a.className="popup";0!=b&&(a.style.top=""+(b-f.Browser.window.scrollY)+"px");return a};var v=function(){};h.Reflect=v;v.__name__=["Reflect"];v.hasField=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};v.field=function(a,b){var c=null;try{c=a[b]}catch(d){}return c};v.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&c.call(a,d)&&b.push(d)}return b};v.isFunction=
function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)};v.deleteField=function(a,b){if(!v.hasField(a,b))return!1;delete a[b];return!0};var e={ds:{}};e.ds.StringMap=function(){this.h={}};h["haxe.ds.StringMap"]=e.ds.StringMap;e.ds.StringMap.__name__=["haxe","ds","StringMap"];e.ds.StringMap.__interfaces__=[H];e.ds.StringMap.prototype={keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return g.iter(a)},exists:function(a){return this.h.hasOwnProperty("$"+
a)},get:function(a){return this.h["$"+a]},set:function(a,b){this.h["$"+a]=b},__class__:e.ds.StringMap};var m=function(){};h.Settings=m;m.__name__=["Settings"];m.optimisedData=function(){for(var a=new e.ds.StringMap,b=m.data.keys();b.hasNext();){var c=b.next(),d=m.data.get(c);m.DEFAULTS.get(c)!=d&&a.set(c,d)}return e.Serializer.run(a)};m.save=function(){e.Serializer.USE_CACHE=!1;f.Browser.window.localStorage.setItem("reditn",m.optimisedData())};m.init=function(){var a=f.Browser.window.localStorage.getItem("reditn");
if(null!=a){var b;try{b=e.Unserializer.run(a)}catch(c){b=m.data}m.data=b}m.fixMissing();a=f.Browser.document.getElementById("header-bottom-right");b=a.getElementsByTagName("ul")[0];var d=f.Browser.document.createElement("a");d.innerHTML="reditn";d.className="pref-lang";d.href="javascript:void(0);";d.onclick=function(){m.settingsPopUp()};null==b?a.appendChild(d):a.insertBefore(d,b);d=f.Browser.document.createElement("span");d.innerHTML=" | ";d.className="seperator";d.style.fontWeight="none";a.insertBefore(d,
b)};m.settingsPopUp=function(){var a=f.Browser.document.getElementById("reditn-config");null!=a&&a.parentNode.removeChild(a);var a=f.Browser.document.createElement("div"),b=f.Browser.document.createElement("h1");b.innerHTML="Reditn settings";a.appendChild(b);j.fullPopUp(a);var c=f.Browser.document.createElement("form");c.id="reditn-config";c.action="javascript:void(0);";c.onchange=function(){for(var a=c.childNodes,b=0;b<a.length;){var d=a[b];++b;if("button"!=d.type&&"input"==d.nodeName.toLowerCase()){var e=
void 0;switch(d.type.toLowerCase()){case "checkbox":e=d.checked;break;default:e=d.value}m.data.set(d.name,e)}}m.save()};b=f.Browser.document.createElement("input");b.type="button";b.value="Restore default settings";b.onclick=function(){m.fixMissing(!0);m.save();m.settingsPopUp()};c.appendChild(b);b=m.makeButton("Export settings to text",function(){f.Browser.window.alert(f.Browser.window.btoa(m.optimisedData()))});c.appendChild(b);b=m.makeButton("Import settings",function(){m.data=e.Unserializer.run(f.Browser.window.atob(f.Browser.window.prompt("Settings to import",
f.Browser.window.btoa(m.optimisedData()))));m.fixMissing();m.save();m.settingsPopUp()});c.appendChild(b);c.appendChild(f.Browser.document.createElement("br"));for(b=m.data.keys();b.hasNext();){var d=b.next(),w=m.data.get(d);if(!f.Boot.__instanceof(w,e.ds.StringMap)&&m.DESC.exists(d)){var g=m.DESC.get(d),k=f.Browser.document.createElement("label");k.setAttribute("for",d);k.style.position="absolute";k.style.width="46%";k.style.textAlign="right";k.innerHTML=""+g+" ";c.appendChild(k);g=f.Browser.document.createElement("input");
g.style.position="absolute";g.style.left="54%";g.style.textAlign="left";g.style.width="46%";g.name=d;c.appendChild(g);c.appendChild(f.Browser.document.createElement("br"));g.type=f.Boot.__instanceof(w,L)?"checkbox":f.Boot.__instanceof(w,String)?"text":f.Boot.__instanceof(w,Date)?"datetime":f.Boot.__instanceof(w,N)?"number":null;f.Boot.__instanceof(w,L)?g.checked=m.data.get(d):g.value=m.data.get(d)}}b=f.Browser.document.createElement("div");b.style.fontWeight="bold";b.innerHTML="Close this dialog and refresh the page to see your changes in effect. Changes will be saved automatically.";
c.appendChild(b);a.appendChild(c)};m.makeButton=function(a,b){var c=f.Browser.document.createElement("input");c.type="button";c.value=a;c.onclick=b;return c};m.fixMissing=function(a){null==a&&(a=!1);for(var b=m.DEFAULTS.keys();b.hasNext();){var c=b.next();if(a||!m.data.exists(c))m.data.set(c,f.Boot.__instanceof(m.DEFAULTS.get(c),e.ds.StringMap)?new e.ds.StringMap:m.DEFAULTS.get(c))}};var q=function(){};h.Std=q;q.__name__=["Std"];q.string=function(a){return f.Boot.__string_rec(a,"")};q.parseInt=function(a){var b=
parseInt(a,10);if(0==b&&(120==g.cca(a,1)||88==g.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};q.parseFloat=function(a){return parseFloat(a)};var A=function(){this.b=""};h.StringBuf=A;A.__name__=["StringBuf"];A.prototype={addSub:function(a,b,c){this.b+=null==c?g.substr(a,b,null):g.substr(a,b,c)},__class__:A};var k=function(){};h.StringTools=k;k.__name__=["StringTools"];k.urlEncode=function(a){return encodeURIComponent(a)};k.urlDecode=function(a){return decodeURIComponent(a.split("+").join(" "))};
k.htmlEscape=function(a,b){a=a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;");return b?a.split('"').join("&quot;").split("'").join("&#039;"):a};k.htmlUnescape=function(a){return a.split("&gt;").join(">").split("&lt;").join("<").split("&quot;").join('"').split("&#039;").join("'").split("&amp;").join("&")};k.startsWith=function(a,b){return a.length>=b.length&&g.substr(a,0,b.length)==b};k.isSpace=function(a,b){var c=g.cca(a,b);return 8<c&&14>c||32==c};k.ltrim=function(a){for(var b=
a.length,c=0;c<b&&k.isSpace(a,c);)c++;return 0<c?g.substr(a,c,b-c):a};k.rtrim=function(a){for(var b=a.length,c=0;c<b&&k.isSpace(a,b-c-1);)c++;return 0<c?g.substr(a,0,b-c):a};k.trim=function(a){return k.ltrim(k.rtrim(a))};k.replace=function(a,b,c){return a.split(b).join(c)};var D=function(){};h.SubredditInfo=D;D.__name__=["SubredditInfo"];D.init=function(){for(var a=f.Browser.document.body.getElementsByClassName("subreddit"),b=0;b<a.length;){var c=a[b];++b;c.onmouseover=D._onMouseOverSubreddit}};D._onMouseOverSubreddit=
function(a){var b=a.target,c=b.innerHTML;a=f.Browser.document.createElement("div");j.popUp(b,a,b.offsetLeft+b.offsetWidth,b.offsetTop);var d=j.getData(e.Json.parse(e.Http.requestUrl("/r/"+c+"/about.json"))),g=j.formatNumber(d.subscribers),b=j.formatNumber(d.accounts_active),h=null!=d.description_html?k.htmlUnescape(d.description_html):null!=d.public_description?y.parse(d.public_description):y.parse(d.description),d=j.age(d.created_utc),c="<b>Name:</b> "+c+" <br>"+("<b>Subscribers:</b> "+g+" <br>"),
c=c+("<b>Active Users:</b> "+b+" <br>"),c=c+("<b>Description:</b> "+h+" <br>"),c=c+("<b>Age:</b> "+d+" <br>");a.innerHTML=c};var G=function(){};h.SubredditTagger=G;G.__name__=["SubredditTagger"];G.init=function(){for(var a=f.Browser.document.body.getElementsByClassName("subreddit"),b=0;b<a.length;){var c=a[b];++b;G.getTag(c)}};G.getTag=function(a){var b=f.Browser.document.createElement("span"),c=k.trim(a.innerHTML),d=m.data.get("sub-tags").exists(c)?m.data.get("sub-tags").get(c):null;b.className=
"flair";var e=f.Browser.document.createElement("span");e.innerHTML=null==d?"":k.htmlEscape(d)+" ";b.appendChild(e);var g=f.Browser.document.createElement("a");g.href="javascript:void(0);";g.innerHTML="[+]";b.appendChild(g);g.onclick=function(){var a=f.Browser.document.createElement("div"),b=f.Browser.document.createElement("label");b.setAttribute("for","tag-change");b.innerHTML="Tag for "+c+" ";a.appendChild(b);var h=f.Browser.document.createElement("input");h.name="tag-change";h.value=d;h.style.width=
"100%";h.onchange=function(){m.data.get("sub-tags").set(c,h.value);e.innerHTML=k.htmlEscape(h.value)+" ";m.save()};a.appendChild(h);j.fullPopUp(a,g.offsetTop+g.offsetHeight);h.focus()};a.parentNode.insertBefore(b,a.nextSibling)};var p=h.ValueType={__ename__:["ValueType"],__constructs__:"TNull TInt TFloat TBool TObject TFunction TClass TEnum TUnknown".split(" ")};p.TNull=["TNull",0];p.TNull.toString=u;p.TNull.__enum__=p;p.TInt=["TInt",1];p.TInt.toString=u;p.TInt.__enum__=p;p.TFloat=["TFloat",2];p.TFloat.toString=
u;p.TFloat.__enum__=p;p.TBool=["TBool",3];p.TBool.toString=u;p.TBool.__enum__=p;p.TObject=["TObject",4];p.TObject.toString=u;p.TObject.__enum__=p;p.TFunction=["TFunction",5];p.TFunction.toString=u;p.TFunction.__enum__=p;p.TClass=function(a){a=["TClass",6,a];a.__enum__=p;a.toString=u;return a};p.TEnum=function(a){a=["TEnum",7,a];a.__enum__=p;a.toString=u;return a};p.TUnknown=["TUnknown",8];p.TUnknown.toString=u;p.TUnknown.__enum__=p;var t=function(){};h.Type=t;t.__name__=["Type"];t.getClassName=function(a){return a.__name__.join(".")};
t.getEnumName=function(a){return a.__ename__.join(".")};t.resolveClass=function(a){a=h[a];return null==a||!a.__name__?null:a};t.resolveEnum=function(a){a=h[a];return null==a||!a.__ename__?null:a};t.createEmptyInstance=function(a){function b(){}b.prototype=a.prototype;return new b};t.createEnum=function(a,b,c){var d=v.field(a,b);if(null==d)throw"No such constructor "+b;if(v.isFunction(d)){if(null==c)throw"Constructor "+b+" need parameters";return d.apply(a,c)}if(null!=c&&0!=c.length)throw"Constructor "+
b+" does not need parameters";return d};t.getEnumConstructs=function(a){return a.__constructs__.slice()};t["typeof"]=function(a){switch(typeof a){case "boolean":return p.TBool;case "string":return p.TClass(String);case "number":return Math.ceil(a)==a%2147483648?p.TInt:p.TFloat;case "object":if(null==a)return p.TNull;var b=a.__enum__;if(null!=b)return p.TEnum(b);a=a.__class__;return null!=a?p.TClass(a):p.TObject;case "function":return a.__name__||a.__ename__?p.TObject:p.TFunction;case "undefined":return p.TNull;
default:return p.TUnknown}};var E=function(){};h.UserInfo=E;E.__name__=["UserInfo"];E.init=function(){for(var a=f.Browser.document.body.getElementsByClassName("author"),b=0;b<a.length;){var c=a[b];++b;c.onmouseover=E._onMouseOverUser}};E._onMouseOverUser=function(a){var b=a.target,c=b.innerHTML,c=g.substr(c,c.lastIndexOf("/")+1,null);a=f.Browser.document.createElement("div");j.popUp(b,a,b.offsetLeft+b.offsetWidth,b.offsetTop);var b=j.getData(e.Json.parse(e.Http.requestUrl("/user/"+c+"/about.json"))),
d=b.name,k=j.age(b.created_utc),c=j.formatNumber(b.link_karma),h=j.formatNumber(b.comment_karma),d="<b>User:</b> "+d+"<br>"+("<b>Account age:</b> "+k+"<br>"),d=d+("<b>Karma:</b> "+c+" link karma, "+h+" comment karma");b.is_mod&&(d+="<br><b>Moderator</b>");b.is_gold&&(d+="<br><b>Gold</b>");a.innerHTML=d};var F=function(){};h.UserTagger=F;F.__name__=["UserTagger"];F.init=function(){for(var a=f.Browser.document.body.getElementsByClassName("author"),b=0;b<a.length;){var c=a[b];++b;F.getTag(c)}};F.getTag=
function(a){var b=f.Browser.document.createElement("span"),c=k.trim(a.innerHTML),d=m.data.get("user-tags").exists(c)?m.data.get("user-tags").get(c):null;b.className="flair";var e=f.Browser.document.createElement("span");e.innerHTML=null==d?"":k.htmlEscape(d)+" ";b.appendChild(e);var g=f.Browser.document.createElement("a");g.href="javascript:void(0);";g.innerHTML="[+]";b.appendChild(g);g.onclick=function(){var a=f.Browser.document.createElement("div"),b=f.Browser.document.createElement("label");b.setAttribute("for",
"tag-change");b.innerHTML="Tag for "+c+" ";a.appendChild(b);var h=f.Browser.document.createElement("input");h.name="tag-change";h.value=d;h.style.width="100%";h.onchange=function(){m.data.get("user-tags").set(c,h.value);e.innerHTML=k.htmlEscape(h.value)+" ";m.save()};a.appendChild(h);j.fullPopUp(a,g.offsetTop+g.offsetHeight);h.focus()};a.parentNode.insertBefore(b,a.nextSibling)};var r={};r.LinkType=h["data.LinkType"]={__ename__:["data","LinkType"],__constructs__:["IMAGE","VIDEO","AUDIO","TEXT","UNKNOWN"]};
r.LinkType.IMAGE=["IMAGE",0];r.LinkType.IMAGE.toString=u;r.LinkType.IMAGE.__enum__=r.LinkType;r.LinkType.VIDEO=["VIDEO",1];r.LinkType.VIDEO.toString=u;r.LinkType.VIDEO.__enum__=r.LinkType;r.LinkType.AUDIO=["AUDIO",2];r.LinkType.AUDIO.toString=u;r.LinkType.AUDIO.__enum__=r.LinkType;r.LinkType.TEXT=["TEXT",3];r.LinkType.TEXT.toString=u;r.LinkType.TEXT.__enum__=r.LinkType;r.LinkType.UNKNOWN=["UNKNOWN",4];r.LinkType.UNKNOWN.toString=u;r.LinkType.UNKNOWN.__enum__=r.LinkType;e.Http=function(a){this.url=
a;this.headers=new e.ds.StringMap;this.params=new e.ds.StringMap;this.async=!0};h["haxe.Http"]=e.Http;e.Http.__name__=["haxe","Http"];e.Http.requestUrl=function(a){a=new e.Http(a);a.async=!1;var b=null;a.onData=function(a){b=a};a.onError=function(a){throw a;};a.request(!1);return b};e.Http.prototype={onStatus:function(){},onError:function(){},onData:function(){},request:function(a){var b=this;b.responseData=null;var c=f.Browser.createXMLHttpRequest(),d=function(){if(4==c.readyState){var a;try{a=c.status}catch(d){a=
null}void 0==a&&(a=null);if(null!=a)b.onStatus(a);if(null!=a&&200<=a&&400>a)b.onData(b.responseData=c.responseText);else if(null==a)b.onError("Failed to connect or resolve host");else switch(a){case 12029:b.onError("Failed to connect to host");break;case 12007:b.onError("Unknown host");break;default:b.responseData=c.responseText,b.onError("Http Error #"+c.status)}}};this.async&&(c.onreadystatechange=d);var e=this.postData;if(null!=e)a=!0;else for(var g=this.params.keys();g.hasNext();)var h=g.next(),
e=null==e?"":e+"&",e=e+(k.urlEncode(h)+"="+k.urlEncode(this.params.get(h)));try{if(a)c.open("POST",this.url,this.async);else if(null!=e){var j=1>=this.url.split("?").length;c.open("GET",this.url+(j?"?":"&")+e,this.async);e=null}else c.open("GET",this.url,this.async)}catch(l){this.onError(l.toString());return}null==this.headers.get("Content-Type")&&(a&&null==this.postData)&&c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(a=this.headers.keys();a.hasNext();)g=a.next(),c.setRequestHeader(g,
this.headers.get(g));c.send(e);this.async||d(null)},setHeader:function(a,b){this.headers.set(a,b);return this},__class__:e.Http};e.Json=function(){};h["haxe.Json"]=e.Json;e.Json.__name__=["haxe","Json"];e.Json.parse=function(a){return(new e.Json).doParse(a)};e.Json.prototype={parseNumber:function(a){for(var b=this.pos-1,c=45==a,d=!c,e=48==a,f=!1,h=!1,j=!1,k=!1;;){a=this.str.charCodeAt(this.pos++);switch(a){case 48:e&&!f&&this.invalidNumber(b);c&&(c=!1,e=!0);d=!0;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e&&
!f&&this.invalidNumber(b);c&&(c=!1);d=!0;e=!1;break;case 46:(c||f)&&this.invalidNumber(b);d=!1;f=!0;break;case 101:case 69:(c||e||h)&&this.invalidNumber(b);d=!1;h=!0;break;case 43:case 45:(!h||j)&&this.invalidNumber(b);d=!1;j=!0;break;default:d||this.invalidNumber(b),this.pos--,k=!0}if(k)break}a=q.parseFloat(g.substr(this.str,b,this.pos-b));b=a|0;return b==a?b:a},invalidNumber:function(a){throw"Invalid number at position "+a+": "+g.substr(this.str,a,this.pos-a);},parseString:function(){for(var a=
this.pos,b=new A;;){var c=this.str.charCodeAt(this.pos++);if(34==c)break;if(92==c){b.addSub(this.str,a,this.pos-a-1);c=this.str.charCodeAt(this.pos++);switch(c){case 114:b.b+="\r";break;case 110:b.b+="\n";break;case 116:b.b+="\t";break;case 98:b.b+="\b";break;case 102:b.b+="\f";break;case 47:case 92:case 34:b.b+=String.fromCharCode(c);break;case 117:a=q.parseInt("0x"+g.substr(this.str,this.pos,4));this.pos+=4;b.b+=String.fromCharCode(a);break;default:throw"Invalid escape sequence \\"+String.fromCharCode(c)+
" at position "+(this.pos-1);}a=this.pos}else if(c!=c)throw"Unclosed string";}b.addSub(this.str,a,this.pos-a-1);return b.b},parseRec:function(){for(;;){var a=this.str.charCodeAt(this.pos++);switch(a){case 32:case 13:case 10:case 9:break;case 123:for(var b={},c=null,a=null;;){var d=this.str.charCodeAt(this.pos++);switch(d){case 32:case 13:case 10:case 9:break;case 125:return(null!=c||!1==a)&&this.invalidChar(),b;case 58:null==c&&this.invalidChar();b[c]=this.parseRec();c=null;a=!0;break;case 44:a?a=
!1:this.invalidChar();break;case 34:a&&this.invalidChar();c=this.parseString();break;default:this.invalidChar()}}break;case 91:b=[];for(a=null;;)switch(d=this.str.charCodeAt(this.pos++),d){case 32:case 13:case 10:case 9:break;case 93:return!1==a&&this.invalidChar(),b;case 44:a?a=!1:this.invalidChar();break;default:a&&this.invalidChar(),this.pos--,b.push(this.parseRec()),a=!0}break;case 116:a=this.pos;if(114!=this.str.charCodeAt(this.pos++)||117!=this.str.charCodeAt(this.pos++)||101!=this.str.charCodeAt(this.pos++))this.pos=
a,this.invalidChar();return!0;case 102:a=this.pos;if(97!=this.str.charCodeAt(this.pos++)||108!=this.str.charCodeAt(this.pos++)||115!=this.str.charCodeAt(this.pos++)||101!=this.str.charCodeAt(this.pos++))this.pos=a,this.invalidChar();return!1;case 110:a=this.pos;if(117!=this.str.charCodeAt(this.pos++)||108!=this.str.charCodeAt(this.pos++)||108!=this.str.charCodeAt(this.pos++))this.pos=a,this.invalidChar();return null;case 34:return this.parseString();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 45:return this.parseNumber(a);
default:this.invalidChar()}}},invalidChar:function(){this.pos--;throw"Invalid char "+this.str.charCodeAt(this.pos)+" at position "+this.pos;},doParse:function(a){this.str=a;this.pos=0;return this.parseRec()},__class__:e.Json};e.Serializer=function(){this.buf=new A;this.cache=[];this.useCache=e.Serializer.USE_CACHE;this.useEnumIndex=e.Serializer.USE_ENUM_INDEX;this.shash=new e.ds.StringMap;this.scount=0};h["haxe.Serializer"]=e.Serializer;e.Serializer.__name__=["haxe","Serializer"];e.Serializer.run=
function(a){var b=new e.Serializer;b.serialize(a);return b.toString()};e.Serializer.prototype={serialize:function(a){var b=t["typeof"](a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:if(0==a){this.buf.b+="z";break}this.buf.b+="i";this.buf.b+=q.string(a);break;case 2:Math.isNaN(a)?this.buf.b+="k":Math.isFinite(a)?(this.buf.b+="d",this.buf.b+=q.string(a)):this.buf.b+=q.string(0>a?"m":"p");break;case 3:this.buf.b+=q.string(a?"t":"f");break;case 6:b=b[2];if(b==String){this.serializeString(a);break}if(this.useCache&&
this.serializeRef(a))break;switch(b){case Array:var c=0;this.buf.b+="a";for(var d=a.length,f=0;f<d;)b=f++,null==a[b]?c++:(0<c&&(1==c?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=q.string(c)),c=0),this.serialize(a[b]));0<c&&(1==c?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=q.string(c)));this.buf.b+="h";break;case B:this.buf.b+="l";for(a=a.iterator();a.hasNext();)b=a.next(),this.serialize(b);this.buf.b+="h";break;case Date:this.buf.b+="v";this.buf.b+=q.string(g.dateStr(a));break;case e.ds.StringMap:this.buf.b+=
"b";for(c=a.keys();c.hasNext();)b=c.next(),this.serializeString(b),this.serialize(a.get(b));this.buf.b+="h";break;case e.ds.IntMap:this.buf.b+="q";for(c=a.keys();c.hasNext();)b=c.next(),this.buf.b+=":",this.buf.b+=q.string(b),this.serialize(a.get(b));this.buf.b+="h";break;case e.ds.ObjectMap:this.buf.b+="M";for(c=a.keys();c.hasNext();)b=c.next(),d=v.field(b,"__id__"),v.deleteField(b,"__id__"),this.serialize(b),b.__id__=d,this.serialize(a.h[b.__id__]);this.buf.b+="h";break;case e.io.Bytes:b=0;c=a.length-
2;d=new A;for(f=e.Serializer.BASE64;b<c;){var h=a.b[b++],j=a.b[b++],k=a.b[b++];d.b+=q.string(f.charAt(h>>2));d.b+=q.string(f.charAt((h<<4|j>>4)&63));d.b+=q.string(f.charAt((j<<2|k>>6)&63));d.b+=q.string(f.charAt(k&63))}b==c?(h=a.b[b++],j=a.b[b++],d.b+=q.string(f.charAt(h>>2)),d.b+=q.string(f.charAt((h<<4|j>>4)&63)),d.b+=q.string(f.charAt(j<<2&63))):b==c+1&&(h=a.b[b++],d.b+=q.string(f.charAt(h>>2)),d.b+=q.string(f.charAt(h<<4&63)));b=d.b;this.buf.b+="s";this.buf.b+=q.string(b.length);this.buf.b+=":";
this.buf.b+=q.string(b);break;default:this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(t.getClassName(b)),this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(t.getClassName(b)),this.cache.push(a),this.serializeFields(a))}break;case 4:if(this.useCache&&this.serializeRef(a))break;this.buf.b+="o";this.serializeFields(a);break;case 7:b=b[2];if(this.useCache&&this.serializeRef(a))break;this.cache.pop();this.buf.b+=q.string(this.useEnumIndex?
"j":"w");this.serializeString(t.getEnumName(b));this.useEnumIndex?(this.buf.b+=":",this.buf.b+=q.string(a[1])):this.serializeString(a[0]);this.buf.b+=":";d=a.length;this.buf.b+=q.string(d-2);for(f=2;f<d;)b=f++,this.serialize(a[b]);this.cache.push(a);break;case 5:throw"Cannot serialize function";default:throw"Cannot serialize "+q.string(a);}},serializeFields:function(a){for(var b=0,c=v.fields(a);b<c.length;){var d=c[b];++b;this.serializeString(d);this.serialize(v.field(a,d))}this.buf.b+="g"},serializeRef:function(a){for(var b=
typeof a,c=0,d=this.cache.length;c<d;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",this.buf.b+=q.string(e),!0}this.cache.push(a);return!1},serializeString:function(a){var b=this.shash.get(a);null!=b?(this.buf.b+="R",this.buf.b+=q.string(b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=k.urlEncode(a),this.buf.b+=q.string(a.length),this.buf.b+=":",this.buf.b+=q.string(a))},toString:function(){return this.buf.b},__class__:e.Serializer};e.Timer=function(a){var b=this;this.id=
setInterval(function(){b.run()},a)};h["haxe.Timer"]=e.Timer;e.Timer.__name__=["haxe","Timer"];e.Timer.stamp=function(){return(new Date).getTime()/1E3};e.Timer.prototype={run:function(){console.log("run")},stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},__class__:e.Timer};e.Unserializer=function(a){this.buf=a;this.length=a.length;this.pos=0;this.scache=[];this.cache=[];a=e.Unserializer.DEFAULT_RESOLVER;null==a&&(a=t,e.Unserializer.DEFAULT_RESOLVER=a);this.setResolver(a)};h["haxe.Unserializer"]=
e.Unserializer;e.Unserializer.__name__=["haxe","Unserializer"];e.Unserializer.initCodes=function(){for(var a=[],b=0,c=e.Unserializer.BASE64.length;b<c;){var d=b++;a[e.Unserializer.BASE64.charCodeAt(d)]=d}return a};e.Unserializer.run=function(a){return(new e.Unserializer(a)).unserialize()};e.Unserializer.prototype={unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:for(var a=
this.pos;;){var b=this.buf.charCodeAt(this.pos);if(43<=b&&58>b||101==b||69==b)this.pos++;else break}return q.parseFloat(g.substr(this.buf,a,this.pos-a));case 121:b=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<b)throw"Invalid string length";a=g.substr(this.buf,this.pos,b);this.pos+=b;a=k.urlDecode(a);this.scache.push(a);return a;case 107:return Math.NaN;case 109:return Math.NEGATIVE_INFINITY;case 112:return Math.POSITIVE_INFINITY;case 97:var c=this.buf,a=[];for(this.cache.push(a);;){b=
this.buf.charCodeAt(this.pos);if(104==b){this.pos++;break}117==b?(this.pos++,b=this.readDigits(),a[a.length+b-1]=null):a.push(this.unserialize())}return a;case 111:return b={},this.cache.push(b),this.unserializeObject(b),b;case 114:b=this.readDigits();if(0>b||b>=this.cache.length)throw"Invalid reference";return this.cache[b];case 82:b=this.readDigits();if(0>b||b>=this.scache.length)throw"Invalid string reference";return this.scache[b];case 120:throw this.unserialize();case 99:b=this.unserialize();
a=this.resolver.resolveClass(b);if(null==a)throw"Class not found "+b;b=t.createEmptyInstance(a);this.cache.push(b);this.unserializeObject(b);return b;case 119:b=this.unserialize();a=this.resolver.resolveEnum(b);if(null==a)throw"Enum not found "+b;b=this.unserializeEnum(a,this.unserialize());this.cache.push(b);return b;case 106:b=this.unserialize();a=this.resolver.resolveEnum(b);if(null==a)throw"Enum not found "+b;this.pos++;var c=this.readDigits(),d=t.getEnumConstructs(a)[c];if(null==d)throw"Unknown enum index "+
b+"@"+c;b=this.unserializeEnum(a,d);this.cache.push(b);return b;case 108:b=new B;for(this.cache.push(b);104!=this.buf.charCodeAt(this.pos);)b.add(this.unserialize());this.pos++;return b;case 98:c=new e.ds.StringMap;for(this.cache.push(c);104!=this.buf.charCodeAt(this.pos);)a=this.unserialize(),c.set(a,this.unserialize());this.pos++;return c;case 113:c=new e.ds.IntMap;this.cache.push(c);for(b=this.buf.charCodeAt(this.pos++);58==b;)a=this.readDigits(),c.set(a,this.unserialize()),b=this.buf.charCodeAt(this.pos++);
if(104!=b)throw"Invalid IntMap format";return c;case 77:c=new e.ds.ObjectMap;for(this.cache.push(c);104!=this.buf.charCodeAt(this.pos);)a=this.unserialize(),c.set(a,this.unserialize());this.pos++;return c;case 118:return b=g.strDate(g.substr(this.buf,this.pos,19)),this.cache.push(b),this.pos+=19,b;case 115:b=this.readDigits();c=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<b)throw"Invalid bytes length";d=e.Unserializer.CODES;null==d&&(d=e.Unserializer.initCodes(),e.Unserializer.CODES=
d);for(var a=this.pos,f=b&3,h=a+(b-f),j=e.io.Bytes.alloc(3*(b>>2)+(2<=f?f-1:0)),l=0;a<h;){var m=d[c.charCodeAt(a++)],n=d[c.charCodeAt(a++)];j.b[l++]=(m<<2|n>>4)&255;m=d[c.charCodeAt(a++)];j.b[l++]=(n<<4|m>>2)&255;n=d[c.charCodeAt(a++)];j.b[l++]=(m<<6|n)&255}2<=f&&(m=d[c.charCodeAt(a++)],n=d[c.charCodeAt(a++)],j.b[l++]=(m<<2|n>>4)&255,3==f&&(m=d[c.charCodeAt(a++)],j.b[l++]=(n<<4|m>>2)&255));this.pos+=b;this.cache.push(j);return j;case 67:b=this.unserialize();a=this.resolver.resolveClass(b);if(null==
a)throw"Class not found "+b;b=t.createEmptyInstance(a);this.cache.push(b);b.hxUnserialize(this);if(103!=this.buf.charCodeAt(this.pos++))throw"Invalid custom data";return b}this.pos--;throw"Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos;},unserializeEnum:function(a,b){if(58!=this.buf.charCodeAt(this.pos++))throw"Invalid enum format";var c=this.readDigits();if(0==c)return t.createEnum(a,b);for(var d=[];0<c--;)d.push(this.unserialize());return t.createEnum(a,b,d)},unserializeObject:function(a){for(;;){if(this.pos>=
this.length)throw"Invalid object";if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if(!f.Boot.__instanceof(b,String))throw"Invalid object key";var c=this.unserialize();a[b]=c}this.pos++},readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45==d){if(this.pos!=c)break;b=!0}else{if(48>d||57<d)break;a=10*a+(d-48)}this.pos++}b&&(a*=-1);return a},setResolver:function(a){this.resolver=null==a?{resolveClass:function(){return null},
resolveEnum:function(){return null}}:a},__class__:e.Unserializer};e.ds.IntMap=function(){this.h={}};h["haxe.ds.IntMap"]=e.ds.IntMap;e.ds.IntMap.__name__=["haxe","ds","IntMap"];e.ds.IntMap.__interfaces__=[H];e.ds.IntMap.prototype={keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b|0);return g.iter(a)},get:function(a){return this.h[a]},set:function(a,b){this.h[a]=b},__class__:e.ds.IntMap};e.ds.ObjectMap=function(){this.h={};this.h.__keys__={}};h["haxe.ds.ObjectMap"]=e.ds.ObjectMap;
e.ds.ObjectMap.__name__=["haxe","ds","ObjectMap"];e.ds.ObjectMap.__interfaces__=[H];e.ds.ObjectMap.prototype={keys:function(){var a=[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return g.iter(a)},set:function(a,b){var c=null!=a.__id__?a.__id__:a.__id__=++e.ds.ObjectMap.count;this.h[c]=b;this.h.__keys__[c]=a},__class__:e.ds.ObjectMap};e.io={};e.io.Bytes=function(a,b){this.length=a;this.b=b};h["haxe.io.Bytes"]=e.io.Bytes;e.io.Bytes.__name__=["haxe","io","Bytes"];
e.io.Bytes.alloc=function(a){for(var b=[],c=0;c<a;)c++,b.push(0);return new e.io.Bytes(a,b)};e.io.Bytes.prototype={__class__:e.io.Bytes};var f={Boot:function(){}};h["js.Boot"]=f.Boot;f.Boot.__name__=["js","Boot"];f.Boot.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<
e;)var g=d++,c=2!=g?c+(","+f.Boot.__string_rec(a[g],b)):c+f.Boot.__string_rec(a[g],b);return c+")"}d=a.length;c="[";b+="\t";for(e=0;e<d;)g=e++,c+=(0<g?",":"")+f.Boot.__string_rec(a[g],b);return c+"]"}try{e=a.toString}catch(h){return"???"}if(null!=e&&e!=Object.toString&&(c=a.toString(),"[object Object]"!=c))return c;e=null;c="{\n";b+="\t";d=null!=a.hasOwnProperty;for(e in a)if(!d||a.hasOwnProperty(e))"prototype"==e||("__class__"==e||"__super__"==e||"__interfaces__"==e||"__properties__"==e)||(2!=c.length&&
(c+=", \n"),c+=b+e+" : "+f.Boot.__string_rec(a[e],b));b=b.substring(1);return c+="\n"+b+"}";case "function":return"<function>";case "string":return a;default:return String(a)}};f.Boot.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var g=d++,g=c[g];if(g==b||f.Boot.__interfLoop(g,b))return!0}return f.Boot.__interfLoop(a.__super__,b)};f.Boot.__instanceof=function(a,b){try{if(a instanceof b)return b==Array?null==a.__enum__:
!0;if(f.Boot.__interfLoop(a.__class__,b))return!0}catch(c){if(null==b)return!1}switch(b){case N:return Math.ceil(a%2147483648)===a;case O:return"number"==typeof a;case L:return!0===a||!1===a;case String:return"string"==typeof a;case P:return!0;default:if(null==a)return!1;if(b==Q&&null!=a.__name__)return!0;null;if(b==R&&null!=a.__ename__)return!0;null;return a.__enum__==b}};f.Browser=function(){};h["js.Browser"]=f.Browser;f.Browser.__name__=["js","Browser"];f.Browser.createXMLHttpRequest=function(){if("undefined"!=
typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw"Unable to create XMLHttpRequest object.";};Array.prototype.indexOf?g.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0}:null;Math.__name__=["Math"];Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;h.Math=Math;Math.isFinite=function(a){return isFinite(a)};Math.isNaN=
function(a){return isNaN(a)};String.prototype.__class__=h.String=String;String.__name__=["String"];Array.prototype.__class__=h.Array=Array;Array.__name__=["Array"];Date.prototype.__class__=h.Date=Date;Date.__name__=["Date"];var N=h.Int={__name__:["Int"]},P=h.Dynamic={__name__:["Dynamic"]},O=h.Float=Number;O.__name__=["Float"];var L=h.Bool=Boolean;L.__ename__=["Bool"];var Q=h.Class={__name__:["Class"]},R={};"undefined"!=typeof JSON&&(e.Json=JSON);l.buttons=[];y.regex=[{from:new n("\\x3E ([^\n]+)",
"g"),to:"<blockquote>$1</blockquote>"},{from:new n("___([^___]+)___","g"),to:"<b><i>$1</i></b>"},{from:new n("\\*\\*([^\\*\\*|\\*]+)\\*\\*","g"),to:"<b>$1</b>"},{from:new n("__([^__|_]+)__","g"),to:"<b>$1</b>"},{from:new n("\\*([^\\*|\\*\\*]+)\\*","g"),to:"<i>$1</i>"},{from:new n("_([^_|__]+)_","g"),to:"<i>$1</i>"},{from:new n("\\[([^\\]]+)\\]\\(([^\\)]+)\\)","g"),to:'<a href="$2">$1</a>'},{from:new n("(.*?)\n\\x3D=*","g"),to:"<h2>$1</h2>"},{from:new n("(.*?)\n\\x2D-*","g"),to:"<h3>$1</h3>"},{from:new n("\\x23\\x23\\x23\\x23\\x23\\x23([^\n]+)\n",
"g"),to:"<h6>$1</h6>"},{from:new n("\\x23\\x23\\x23\\x23\\x23([^\n]+)\n","g"),to:"<h5>$1/h5>"},{from:new n("\\x23\\x23\\x23\\x23([^\n]+)\n","g"),to:"<h4>$1</h4>"},{from:new n("\\x23\\x23\\x23([^\n]+)\n","g"),to:"<h3>$1</h3>"},{from:new n("\\x23\\x23([^\n]+)\n","g"),to:"<h2>$1</h2>"},{from:new n("\\x23([^\n]+)\n","g"),to:"<h1>$1</h1>"},{from:new n("\n?([^\n]+)\n\n","g"),to:"<p>$1</p>"},{from:new n("\n?([^\n]+)\n","g"),to:"$1 "},{from:new n("\n[\\+\\*\\-] ([^\n]+)","g"),to:"<li><p>$1</p></li>"},{from:new n("\n[0-9]*[.\\):]([^\n]+)",
"g"),to:"<li><p>$1</p></li>"},{from:new n("\\x3Cli\\x3E([^\n+]+)\\x3C/li\\x3E",""),to:"<ul><li>$1</li></ul>"}];j.fullPage=!0;n=new e.ds.StringMap;n.set("adblock","Block advertisements and sponsors");n.set("userinfo","Show information about a user upon hover");n.set("subinfo","Show information about a subreddit upon hover");n.set("expand","Allow expansion of images");n.set("dup-hider","Hide duplicate links");n.set("user-tag","Tag users");n.set("sub-tag","Tag subreddits");n.set("preview","Preview comments and posts");
n.set("keys","Keyboard shortcuts");n.set("nsfw-filter","Hide NSFW content");m.DESC=n;n=new e.ds.StringMap;n.set("adblock",!0);n.set("userinfo",!0);n.set("subinfo",!0);n.set("expand",!0);n.set("dup-hider",!0);n.set("user-tag",!0);n.set("sub-tag",!0);n.set("preview",!0);n.set("keys",!0);n.set("nsfw-filter",!0);n.set("user-tags",new e.ds.StringMap);n.set("sub-tags",new e.ds.StringMap);m.DEFAULTS=n;m.data=new e.ds.StringMap;e.Serializer.USE_CACHE=!1;e.Serializer.USE_ENUM_INDEX=!1;e.Serializer.BASE64=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";e.Unserializer.DEFAULT_RESOLVER=t;e.Unserializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";e.ds.ObjectMap.count=0;f.Browser.window="undefined"!=typeof window?window:null;f.Browser.document="undefined"!=typeof window?window.document:null;j.main()})();
